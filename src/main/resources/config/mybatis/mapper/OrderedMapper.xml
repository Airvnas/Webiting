<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.product.mapper.OrderedMapper">
	

	<insert id="insertOrdered" parameterType="Ordered">
		<selectKey keyProperty="orderedNum" resultType="_int" order="BEFORE">
			select ordernum_seq.nextval from dual
		</selectKey>
		insert into ordered(title, orderednum,ordered_from_tel,ordered_from_post,ordered_no,ordered_to_name,ordered_to_tel,
		ordered_to_email,ordered_to_adr,ordered_to_post,ordered_payhow,ordered_paystate,ordered_orderprice,ordered_date,idx_fk,pnum_fk,ordered_delivstateNum_fk,ordered_from_adr,pname,oqty,price,saleprice,pimage,pcompany,totalPrice,totalPoint, ordered_statusNum_fk) 
		values(#{title},#{orderedNum},#{ordered_from_tel},#{ordered_from_post}, #{ordered_no},#{ordered_to_name},#{ordered_to_tel},
		#{ordered_to_email},#{ordered_to_adr},#{ordered_to_post},#{ordered_payhow},#{ordered_paystate},#{ordered_orderprice},sysdate,#{idx_fk},#{pnum_fk},0,#{ordered_from_adr},#{pname},#{oqty},#{price},#{saleprice},#{pimage},#{pcompany},#{totalPrice},#{totalPoint},0)
	</insert>
		
	<select id="selectAll" resultType="Ordered">
		select * from orderedview
	</select>	
	
	<update id="delivCompleted" parameterType="String">
		update orderedview set ordered_delivstateNum_fk=1 where orderednum=#{value}
	</update>
	
	<select id="selectOrdered" resultType="Ordered" parameterType="string">
		select * from orderedview where ordered_no=#{value}
	</select>
	
	<select id="selectOrderedByidx" resultType="Order" parameterType="int">
		select * from orderview where idx=#{value}
	</select>
	
	<select id="selectOrderedByOnum" resultType="Order" parameterType="String">
		select * from orderview where ordered_no=#{value}
	</select>
	
	<insert id="insertOrder" parameterType="Order">
		insert into ordertable(title, ordered_no, ordered_to_name, ordered_to_tel, ordered_to_email, ordered_to_adr, ordered_to_post, ordered_payhow, ordered_paystate, ordered_orderprice, ordered_date, idx)
		values(#{title}, #{ordered_no}, #{ordered_to_name},#{ordered_to_tel}, #{ordered_to_email},#{ordered_to_adr},#{ordered_to_post},#{ordered_payhow},#{ordered_paystate},#{ordered_orderprice}, sysdate, #{idx})	
	</insert>
	
</mapper>